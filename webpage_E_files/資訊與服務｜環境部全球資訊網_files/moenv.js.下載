function contentEncode(e,i){var t=document.createElement("span"),n=encodeURI(i?e.attr(i):e.textContent),a=decodeURI(n);return t.appendChild(document.createTextNode(a)),t.innerHTML}$(document).ready(function(){var e=$(".cd-accordion-menu");e.length>0&&e.each(function(){var e=$(this);e.on("change",'input[type="checkbox"]',function(){var e=$(this);e.prop("checked")?e.siblings("ul").attr("style","display:none;").slideDown(300):e.siblings("ul").attr("style","display:block;").slideUp(300)})})}),$(document).ready(function(){function e(e){var i=contentEncode(e,"data-closetitle");$(".footerAll>ul>li>ul").slideDown(350),$("footer").removeClass("off"),e.attr("title",i).html(i)}function i(e){var i=contentEncode(e,"data-opentitle");$(".footerAll>ul>li>ul").slideUp(350),e.attr("title",i).html(i),setTimeout(function(){$("footer").addClass("off")},250)}function t(){function e(){i=$(".kv1SwiperJs .swiper-slide"),t=$(".kv1SwiperJs .swiper-slide-active"),n=$(".kv1SwiperPageJs .swiper-pagination-bullet"),a=$(".kv1SwiperPageJs .swiper-pagination-bullet-active"),i.attr("aria-hidden","true"),i.find("a, iframe").attr("tabindex",-1),t.attr("aria-hidden",""),t.find("a, iframe").attr("tabindex",""),n.attr("aria-current",""),a.attr("aria-current","true")}if($(".kv1SwiperJs .swiper-slide").length>1){var i,t,n,a,s=[];$(".kv1SwiperJs .swiper-slide").each(function(){s.push($(this).find(".swiperTxt").text())});var r=new Swiper(".kv1SwiperJs",{preloadImages:!1,lazy:!0,pagination:{el:".kv1SwiperPageJs",clickable:!0,renderBullet:function(e,i){return'<span class="'+i+'"><i>'+s[e]+"</i></span>"}},navigation:{prevEl:".kv1SwiperPrevBtnJs",nextEl:".kv1SwiperNextBtnJs"},a11y:{prevSlideMessage:contentEncode($(".kv1SwiperPrevBtnJs span")[0]),nextSlideMessage:contentEncode($(".kv1SwiperNextBtnJs span")[0])},autoplay:{delay:7e3,disableOnInteraction:!1},loop:!0,observer:!0,observeParents:!0,watchOverflow:!0,on:{afterInit:function(){e()},slideChangeTransitionEnd:function(){e()}}});$(".kv1SwiperJs .swiperCon").on("focus",function(){r.autoplay.stop()}),$(".kv1SwiperPrevBtnJs,.kv1SwiperNextBtnJs").on("focus",function(){r.autoplay.stop()}),$(".kv1SwiperPrevBtnJs,.kv1SwiperNextBtnJs").on("mousedown",function(e){e.preventDefault()}),$($(".kv1SwiperJs .swiperCon")).on("keydown",function(e){9===e.which&&e.shiftKey&&r.autoplay.start()}),$(".kv1SwiperNextBtnJs").on("keydown",function(e){9!==e.which||e.shiftKey||r.autoplay.start()})}else $(".kv1SwiperJs").addClass("oneKv"),$(".kv1SwiperJs").find(".swiper-lazy").each(function(){var e=contentEncode($(this),"data-background");$(this).css("background-image","url("+e+")")}),$(".kv1SwiperJs").find(".swiper-lazy-preloader").remove()}function n(){function e(){var e=parseInt(u*c);l.eq(0).animate({left:u*-1},e,"linear",function(){l.css({top:"-2em",left:0}),setTimeout(function(){l.animate({top:"0"},d,function(){i()})},d)})}function i(){setTimeout(e,o)}function t(e){var i=$(".hintJs").innerWidth(),t=l.eq(e).innerWidth(),s=e-1>=0?e-1:p-1;if(t<i)n(e,s);else{var r=parseInt(t*c);a(e,s,t,r)}}function n(e,i){l.eq(e).animate({top:0},d,"linear"),s(i);var n=e===p-1?0:++e;m=setTimeout(t,o,n)}function a(e,i,n,a){l.eq(e).animate({top:0},d,"linear",function(){m=setTimeout(function(){l.eq(e).animate({left:n*-1},a,"linear",function(){var i=e===p-1?0:++e;m=setTimeout(t,500,i)})},2e3)}),s(i)}function s(e){l.eq(e).animate({top:r},d,"linear",function(){l.eq(e).css({top:"-2em",left:0})})}var r="2em",o=7e3,d=850,c=15,l=$(".hintJs li"),p=l.length;if(clearTimeout(m),l.stop().css({top:"-"+r,left:0}),0==p)return!1;if(1==p){var f=$(".hintJs").innerWidth(),u=l.eq(0).innerWidth();l.css("top",0),u>f&&i()}p>1&&(l.css("top","-"+r),t(0)),l.find("a").on("focus",function(){var e=$(this).parent("li").index();clearTimeout(m),l.css({top:"-"+r,left:0}),l.eq(e).stop().css({top:0,left:0})}).on("mousedown",function(e){e.preventDefault()}),$(".closeHintJs").on("click",function(){$(".hintBar").addClass("off"),clearTimeout(m),$(".hintJs").removeClass("hintJs"),$(".hintBar").slideUp(400)})}function a(){function e(){$slides=$(".pic1SwiperJs .swiper-slide"),$activeSlides=$(".pic1SwiperJs .swiper-slide-active"),$dot=$(".pic1SwiperPageJs .swiper-pagination-bullet"),$activeDot=$(".pic1SwiperPageJs .swiper-pagination-bullet-active"),$slides.attr("aria-hidden","true"),$slides.find("a, iframe").attr("tabindex",-1),$activeSlides.attr("aria-hidden",""),$activeSlides.find("a, iframe").attr("tabindex",""),$dot.attr("aria-current",""),$activeDot.attr("aria-current","true")}if($(".pic1SwiperJs .swiper-slide").length>1){var i=[];$(".pic1SwiperJs .swiper-slide").each(function(){i.push($(this).find(".swiperTxt").text())});var t=new Swiper(".pic1SwiperJs",{preloadImages:!1,pagination:{el:".pic1SwiperPageJs",clickable:!0,renderBullet:function(e,t){return'<span class="'+t+'"><i>'+i[e]+"</i></span>"}},navigation:{prevEl:".pic1SwiperPrevBtnJs",nextEl:".pic1SwiperNextBtnJs"},a11y:{prevSlideMessage:contentEncode($(".pic1SwiperPrevBtnJs span")[0]),nextSlideMessage:contentEncode($(".pic1SwiperNextBtnJs span")[0])},autoplay:{delay:7e3,disableOnInteraction:!1},loop:!0,observer:!0,observeParents:!0,watchOverflow:!0,on:{afterInit:function(){e()},slideChangeTransitionEnd:function(){e()}}});$(".pic1SwiperJs .slideCon").on("focus",function(){t.autoplay.stop()}),$(".pic1SwiperPrevBtnJs,.pic1SwiperNextBtnJs").on("focus",function(){t.autoplay.stop()}),$(".pic1SwiperPrevBtnJs,.pic1SwiperNextBtnJs").on("mousedown",function(e){e.preventDefault()}),$($(".pic1SwiperJs .slideCon")).on("keydown",function(e){9===e.which&&e.shiftKey&&t.autoplay.start()}),$(".pic1SwiperNextBtnJs").on("keydown",function(e){9!==e.which||e.shiftKey||t.autoplay.start()})}else $(".pic1SwiperJs").addClass("onePic1")}function s(){function e(){a=$(".idxVideo1SwiperJs .swiper-slide"),i=$(".idxVideo1SwiperJs .swiper-slide-active"),t=$(".idxVideo1SwiperPageJs .swiper-pagination-bullet"),n=$(".idxVideo1SwiperPageJs .swiper-pagination-bullet-active"),a.attr("aria-hidden","true"),a.find("a, iframe").attr("tabindex",-1),i.attr("aria-hidden",""),i.find("a, iframe").attr("tabindex",""),t.attr("aria-current",""),n.attr("aria-current","true")}if($(".idxVideo1SwiperJs .swiper-slide").length>1){var i,t,n,a=$(".idxVideo1SwiperJs .swiper-slide"),s=[];a.each(function(){s.push($(this).find(".swiperTxt").text())});new Swiper(".idxVideo1SwiperJs",{preloadImages:!1,pagination:{el:".idxVideo1SwiperPageJs",clickable:!0,renderBullet:function(e,i){return'<span class="'+i+'"><i>'+s[e]+"</i></span>"}},navigation:{prevEl:".idxVideo1SwiperPrevBtnJs",nextEl:".idxVideo1SwiperNextBtnJs"},a11y:{prevSlideMessage:contentEncode($(".idxVideo1SwiperPrevBtnJs span")[0]),nextSlideMessage:contentEncode($(".idxVideo1SwiperNextBtnJs span")[0])},effect:"fade",fadeEffect:{crossFade:!0},observer:!0,observeParents:!0,watchOverflow:!0,on:{afterInit:function(){e()},reachBeginning:function(){e()},slideChangeTransitionEnd:function(){e()}}})}}function r(){function e(){a=$(".idxVideo2SwiperJs .swiper-slide"),i=$(".idxVideo2SwiperJs .swiper-slide-active"),t=$(".idxVideo2SwiperPageJs .swiper-pagination-bullet"),n=$(".idxVideo2SwiperPageJs .swiper-pagination-bullet-active"),a.attr("aria-hidden","true"),a.find("a, iframe").attr("tabindex",-1),i.attr("aria-hidden",""),i.find("a, iframe").attr("tabindex",""),t.attr("aria-current",""),n.attr("aria-current","true")}if($(".idxVideo2SwiperJs .swiper-slide").length>1){var i,t,n,a=$(".idxVideo2SwiperJs .swiper-slide"),s=[];a.each(function(){s.push($(this).find(".swiperTxt").text())});new Swiper(".idxVideo2SwiperJs",{preloadImages:!1,pagination:{el:".idxVideo2SwiperPageJs",clickable:!0,renderBullet:function(e,i){return'<span class="'+i+'"><i>'+s[e]+"</i></span>"}},navigation:{prevEl:".idxVideo2SwiperPrevBtnJs",nextEl:".idxVideo2SwiperNextBtnJs"},a11y:{prevSlideMessage:contentEncode($(".idxVideo2SwiperPrevBtnJs span")[0]),nextSlideMessage:contentEncode($(".idxVideo2SwiperNextBtnJs span")[0])},effect:"fade",fadeEffect:{crossFade:!0},observer:!0,observeParents:!0,watchOverflow:!0,on:{afterInit:function(){e()},reachBeginning:function(){e()},slideChangeTransitionEnd:function(){e()}}})}}function o(){function e(){a=$(".idxVideo3SwiperJs .swiper-slide"),i=$(".idxVideo3SwiperJs .swiper-slide-active"),t=$(".idxVideo3SwiperPageJs .swiper-pagination-bullet"),n=$(".idxVideo3SwiperPageJs .swiper-pagination-bullet-active"),a.attr("aria-hidden","true"),a.find("a, iframe").attr("tabindex",-1),i.attr("aria-hidden",""),i.find("a, iframe").attr("tabindex",""),t.attr("aria-current",""),n.attr("aria-current","true")}if($(".idxVideo3SwiperJs .swiper-slide").length>1){var i,t,n,a=$(".idxVideo3SwiperJs .swiper-slide"),s=[];a.each(function(){s.push($(this).find(".swiperTxt").text())});new Swiper(".idxVideo3SwiperJs",{preloadImages:!1,pagination:{el:".idxVideo3SwiperPageJs",clickable:!0,renderBullet:function(e,i){return'<span class="'+i+'"><i>'+s[e]+"</i></span>"}},navigation:{prevEl:".idxVideo3SwiperPrevBtnJs",nextEl:".idxVideo3SwiperNextBtnJs"},a11y:{prevSlideMessage:contentEncode($(".idxVideo3SwiperPrevBtnJs span")[0]),nextSlideMessage:contentEncode($(".idxVideo3SwiperNextBtnJs span")[0])},effect:"fade",fadeEffect:{crossFade:!0},observer:!0,observeParents:!0,watchOverflow:!0,on:{afterInit:function(){e()},reachBeginning:function(){e()},slideChangeTransitionEnd:function(){e()}}})}}function d(){function e(){$(".linksSwiperPrevBtnJs").hasClass("swiper-button-lock")?$(".linksSwiperJs .swiper-wrapper").css("justify-content","center"):$(".linksSwiperJs .swiper-wrapper").css("justify-content","")}var i;i=$(".linksSwiperPrevBtnJs").length?{prevSlideMessage:contentEncode($(".linksSwiperPrevBtnJs")[0]),nextSlideMessage:contentEncode($(".linksSwiperNextBtnJs")[0])}:{enabled:!0};new Swiper(".linksSwiperJs",{preloadImages:!1,navigation:{prevEl:".linksSwiperPrevBtnJs",nextEl:".linksSwiperNextBtnJs"},a11y:i,observer:!0,observeParents:!0,breakpoints:{1200:{slidesPerGroup:5,slidesPerView:5},992:{slidesPerGroup:4,slidesPerView:4},768:{slidesPerGroup:3,slidesPerView:3},500:{slidesPerGroup:2,slidesPerView:2}},on:{afterInit:function(){e()},resize:function(){e()}}})}function c(){function e(e){if(e.parents(i).hasClass("navSetTarget")){var n=contentEncode(e,"data-target");"undefined"!=n&&(e.addClass("on").parent("li").siblings().find("a").removeClass("on"),$("#"+n).fadeIn().siblings().hide())}else e.addClass("on").parent("li").siblings().find("a").removeClass("on"),e.parents().hasClass("idxBusinessNav")||e.parents(".idxVideoNav").length||e.parents(i).next(t).children("div").eq(e.parent("li").index()).fadeIn().siblings().hide(),e.parents().hasClass("idxBusinessNav")&&$(".idxBusinessR").find(t).children("div").eq(e.parent("li").index()).fadeIn().siblings().hide(),e.parents(".idxVideoNav").length&&e.parents(i).next(t).children("div").eq(e.parent("li").index()).css("visibility","visible").fadeIn().siblings().hide().css("visibility","hidden")}var i=$(".tabCon1NavJs"),t=$(".tabCon1ConJs");i.each(function(){var i=$(this).find(".on").parent("li").index();i<0&&(i=0),$(this).find("a").on("click",function(){e($(this))}).eq(i).click()})}function l(){$(".moreListJs").each(function(){var e=$(this),i=e.find(".listI").length;e.attr("data-num",i),i<=3&&e.addClass("less3"),i<=4&&e.addClass("less4"),i<=6&&e.addClass("less6"),i<=8&&e.addClass("less8"),i<=10&&e.addClass("less10")}),$(".moreBtnJs").each(function(){var e=$(this);e.on("click",function(){e.parent(".btnBar1").addClass("hide"),e.parent(".btnBar1").prev(".moreListJs").addClass("showAll")})})}function p(){C=$(window).outerWidth()<=768}function f(){y=$(window).outerWidth()<=1024}function u(){if(0==y){var e=$(".navbar-toggle").attr("aria-expanded");"true"==e&&$(".navbar-toggle").click()}}function h(){0==y?($(".mobile_close").prop("checked",!0),$(".cd-accordion-menu.left_menu4 ul,.cd-accordion-menu.left_menu3 ul,.cd-accordion-menu.left_menu2 ul").attr("style","display:block;")):($(".mobile_close").prop("checked",!1),$(".cd-accordion-menu.left_menu4 ul,.cd-accordion-menu.left_menu3 ul,.cd-accordion-menu.left_menu2 ul").attr("style","display:none;"),$(".control2 .left_menu2").eq(0).find("ul").attr("style","display:block;").siblings(".mobile_close").prop("checked",!0))}function w(){($(".idxMapCon").length||$(".fansPageWrap").length)&&(P=$(this).height(),B=$(this).scrollTop()),$(".idxMapCon").length&&!V&&v(),$(".fansPageWrap").length&&!E&&g()}function v(){var e=$(".idxMapCon").offset().top,i=$(".idxMapCon").outerHeight()/4;B>e+i-P&&B<e+i&&B+P>e+i&&(V=!0,$(".idxMapCon .idxMapConI").eq(0).find("iframe").css("display","block"))}function g(){var e=$(".fansPageWrap").offset().top,i=$(".fansPageWrap").outerHeight()/4;B>e+i-P&&B<e+i&&B+P>e+i&&(E=!0,S())}function S(){var e,i,t=$(".fansPageJs"),n=t.find("iframe"),a=$(".idxVideoSocialL"),s=t.outerWidth(),r=a.outerHeight();e=Math.round(t.outerWidth()),0==C?i=Math.round(a.outerHeight()):(e>=500&&(e=500),i=Math.round(t.outerHeight())),(0==T||1==T&&e!=s)&&(n.attr("src",""),n.width(e),n.height(i),n.attr("src","https://www.facebook.com/plugins/likebox.php?href=https%3A%2F%2Fwww.facebook.com%2FMOENV.TW&width="+e+"&height="+i+"&colorscheme=light&show_faces=false&header=false&stream=true&show_border=true&small_header=false"),s=e,r=i)}function x(){0==I&&($(".tabCon1ConJs").length&&$(".tabCon1ConJs iframe").attr("loading","").css("display","block"),$(".fansPageJs").length&&S(),I=!0)}function J(e){var i=120,t=e[0].innerHTML,n=encodeURIComponent(t),a=t.split("<br>"),s=0,r=[],o=!0,d=encodeURIComponent(e.data("moretitle")),c=encodeURIComponent(e.data("moreicon"));$.each(a,function(t,n){var a,l=n;0!=o&&(s+=$.trim(l).length,s>i?(s=i-(s-$.trim(l).length),s>i?r.push("..."):r.push(l.substring(0,s)+'...<span class="ci-filetype">'+decodeURIComponent(c)+"</span>"),o=!1,a=r.join("<br>"),e[0].innerHTML='<a class="moreTxt" href="javascript:;" title='+decodeURIComponent(d)+">"+a+"</a>"):(r.push(l),a=r.join("<br>"),e[0].innerHTML=a))}),e.on("click",".moreTxt",function(){$(this).parent(".summary").empty().html(decodeURIComponent(n))})}var m,b,k=$(window).width(),C=!1,y=!1;$("body").on("click",".searchSwitch",function(){if($(this).hasClass("on")){var e=contentEncode($(this),"data-opentitle");$(this).removeClass("on"),$(this).next(".search_wrap").stop(!0,!0).slideUp(400),$(this).attr("title",e).find(".text-hidden").text(e)}else{var i=contentEncode($(this),"data-closetitle");$(this).addClass("on"),$(this).next(".search_wrap").stop(!0,!0).slideDown(400),$(this).attr("title",i).find(".text-hidden").text(i),setTimeout(function(){$("#navbar-menu > .search_wrap > .KeyWord").setfocus()},400)}}),$(".search-button").focusout(function(){$(".searchSwitch").removeClass("on"),$(".searchSwitch").next(".search_wrap").slideUp();var e=contentEncode($(".searchSwitch"),"data-opentitle");$(".searchSwitch").attr("title",e).find(".text-hidden").text(e)}),$(".ftNav").hasClass("off")?i($(".ftNavSwitchJs")):e($(".ftNavSwitchJs")),$("body").on("click",".ftSwitchJs",function(){$("footer").hasClass("off")?e($(this)):i($(this))}),$(".kv1SwiperJs").length&&t(),$(".hintJs").length&&n(),$(".pic1SwiperJs").length&&a(),$(".idxVideo1SwiperJs").length&&(s(),$(".ytWrap iframe").each(function(e){var i=$(this);i.contents().on("keydown",function(e){13===e.which&&setTimeout(function(){i.focus()},200)})})),$(".idxVideo2SwiperJs").length&&r(),$(".idxVideo3SwiperJs").length&&o(),$(".linksSwiperJs").length&&d(),$(".tabCon1NavJs").length&&c(),$(".moreListJs").length&&l(),p(),f(),$(".left_menu2").length&&h();var P,B,V=!1,E=!1,T=!1,I=!1;w();var N=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(N){var M=window.matchMedia("print");M.addListener(function(e){e.matches&&x()})}else window.onbeforeprint=function(){x()};$(window).on("resize",function(){clearTimeout(b),b=setTimeout(function(){$(window).width()!=k&&(k=$(window).width(),p(),f(),u(),$(".fansPageJs").length&&S(),$(".left_menu2").length&&h())},250)}),$(window).scroll(function(){$(this).scrollTop()>180?$(".searchSwitch").addClass("searchSwitchFixed"):$(".searchSwitch").removeClass("searchSwitchFixed")}),($(".idxMapCon").length||$(".fansPageWrap").length)&&$(window).scroll(function(){w()}),$(".timeList").length&&$(".timeList .summary").each(function(){J($(this))})});